Create table N_ROLLCALL(
id number(3),name varchar(15), age number(3));
Create table O_ROLLCALL(
id number(3),name varchar(15), age number(3));
Insert into N_ROLLCALL values (&id, '&name',&age);
Insert into O_ROLLCALL values (&id, '&name',&age);

DECLARE 
  CURSOR c_new_rollcall IS 
    SELECT * FROM N_ROLLCALL; 
     
  v_exists NUMBER; 
BEGIN 
  FOR n_rec IN c_new_rollcall LOOP 
 
 -- Check if the record exists in O_ROLLCALL 
    SELECT COUNT(*) INTO v_exists 
    FROM O_ROLLCALL 
    WHERE o_id = n_rec.o_id;
    
    IF v_exists = 0 THEN 
      INSERT INTO O_ROLLCALL (o_id, column1, column2, ...)  
      VALUES (n_rec.o_id, n_rec.column1, n_rec.column2, ...);     
    ELSE 
      DBMS_OUTPUT.PUT_LINE('Record with o_id ' || n_rec.o_id || ' already exists. Skipping.'); 
    END IF; 
  END LOOP; 
    COMMIT;  
  DBMS_OUTPUT.PUT_LINE('Merge process completed.'); 
EXCEPTION 
  WHEN OTHERS THEN 
    
    DBMS_OUTPUT.PUT_LINE('Error occurred: ' || SQLERRM); 
    ROLLBACK;
END;
